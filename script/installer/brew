#!/bin/bash
set -euxo

/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"

if [ -d /opt/homebrew ]; then # On ARM macOS, brew will be installed to /opt/homebrew
    export PATH="/opt/homebrew/bin:$PATH"
fi

formulas=(
    bat
    bottom
    clipper
    cmake
    difftastic
    direnv
    dust
    emacs
    exa
    fd
    fish
    fzf
    # gh
    # git
    git-delta
    git-lfs
    htop
    hugo
    hyperfine
    jc
    jq
    latexit
    lazygit
    macos-trash
    mactex-no-gui
    mas
    monolith
    ncdu
    poppler
    procs
    pueue
    ripgrep
    ripgrep-all
    shellcheck
    starship
    tealdeer
    tmux
    tokei
    unar
    viu
    xh
    zoxide
)

formulascask=(
    1password
    adobe-acrobat-reader
    alfred
    bartender
    bettertouchtool
    cmd-eikana
    deepl
    discord
    dropbox
    firefox
    font-cica
    font-juliamono
    google-chrome
    iterm2
    julia
    krisp
    latexit
    loopback
    mactex-no-gui
    microsoft-edge
    microsoft-office
    monitorcontrol
    pdf-expert
    slack
    spotify
    veracrypt
    visual-studio-code
    wezterm
    xquartz
    zoom
)


brew update

for formula in "${formulas[@]}"; do
    if ! brew list --versions "$formula"; then
        brew install "$formula"
    fi
done

brew tap homebrew/cask-fonts
if [[ "$(uname -m)" == "arm64" ]]; then
    sudo softwareupdate --install-rosetta
fi

for formula in "${formulascask[@]}"; do
    if ! brew list --cask --versions "$formula"; then
        brew install --cask "$formula"
    fi
done

brew services start clipper
brew services start pueue
